<?xml version="1.0" encoding="UTF-8"?>
<Classe nome="W9Query" versione="1.0.0">
 
<!-- Select -->
    <metodo nome="selectObject">
    	 <query nome="W9LISTASTAZIONIAPPALTANTI" tipo="select">
    	 	select distinct CODEIN 
    	 	from W9GARA 
	   	</query>
	   	<query nome="W9LOTT_LISTA" tipo="select">
    	 	select W9GARA.CODGARA, W9LOTT.CODLOTT 
    	 	from W9GARA, W9LOTT 
    	 	where W9GARA.CODGARA = W9LOTT.CODGARA 
    	 	and W9LOTT.TIPO_CONTRATTO IN ('L','F','S')
    	 	and W9LOTT.IMPORTO_TOT >= 40000  
    	 	and	W9LOTT.DAEXPORT = '1' 
	   	</query>    
	   	<query nome="W9LOTT_AGGIORNADAEXPORT" tipo="select">
    	 	update W9LOTT set DAEXPORT = '2' 
    	 	where W9LOTT.CODGARA = ? AND W9LOTT.CODLOTT = ?
	   	</query>
	   	<query nome="W9DATICOMUNI" tipo="select">
	    	select W9LOTT.CIG, W9LOTT.FLAG_ENTE_SPECIALE, W9LOTT.TIPO_CONTRATTO, W9GARA.CF_SA_AGENTE, SUBSTR(W9GARA.DENOM_SA_AGENTE,1,250),
		      	CENTRICOSTO.CODCENTRO, CENTRICOSTO.DENOMCENTRO, W9GARA.ID_TIPOLOGIA_SA, W9GARA.FLAG_SA_AGENTE, W9LOTT.RUP,
		      	LPAD(TO_CHAR(UFFINT.TIPOIN),2,'0'), UFFINT.CFEIN, UFFINT.NOMEIN, UFFINT.CFEIN, UFFINT.NOMEIN, W9LOTT.ESITO_PROCEDURA,
		      	case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9LOTT.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
						case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9LOTT.ID_SCHEDA_SIMOG else ''  end as ID_SCHEDA_SIMOG,
						W9GARA.TIPOLOGIA_PROCEDURA, NVL(W9ESITO.ESITO_PROCEDURA, case when W9APPA.CODGARA is not null then 1 end) as ESITO_PROCEDURA,
						W9GARA.FLAG_CENTRALE_STIPULA, W9GARA.DURATA_ACCQUADRO
  			from W9GARA, W9LOTT left outer join W9esito on W9LOTT.CODLOTT = W9ESITO.CODLOTT AND W9LOTT.CODGARA = W9ESITO.CODGARA
  					left join W9APPA on W9LOTT.CODLOTT=W9APPA.CODLOTT AND W9LOTT.CODGARA=W9APPA.CODGARA, CENTRICOSTO, UFFINT
			where W9LOTT.CODGARA = ? AND W9LOTT.CODLOTT = ? AND
		      	W9GARA.CODGARA = W9LOTT.CODGARA AND
		      	W9GARA.IDCC = CENTRICOSTO.IDCENTRO AND 
		      	W9GARA.CODEIN = UFFINT.CODEIN
	   	</query>
		<query nome="W9RUP" tipo="select">
	   		select TECNI.CFTEC, TECNI.PIVATEC
	   		  from TECNI, W9LOTT
			   where W9LOTT.CODGARA = ? AND
				       W9LOTT.CODLOTT = ? AND
				       W9LOTT.RUP = TECNI.CODTEC
    	</query>	   	
		<query nome="W9PUBB" tipo="select">
    		select W9PUBB.DATA_GUCE, W9PUBB.DATA_GURI, W9PUBB.DATA_ALBO, NVL(W9PUBB.QUOTIDIANI_NAZ,0), NVL(W9PUBB.QUOTIDIANI_REG,0), 
	    		 NVL(W9PUBB.PROFILO_COMMITTENTE,'1'), NVL(W9PUBB.SITO_MINISTERO_INF_TRASP,'2'), NVL(W9PUBB.SITO_OSSERVATORIO_CP,W9GARA.PREV_BANDO), W9PUBB.DATA_BORE, W9PUBB.PERIODICI,
	    		 case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9LOTT.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				 W9LOTT.ID_SCHEDA_SIMOG
			from W9GARA join W9LOTT on W9GARA.CODGARA=W9LOTT.CODGARA left outer join W9PUBB on W9PUBB.CODGARA = W9GARA.CODGARA
			where W9LOTT.CODGARA = ? AND W9LOTT.CODLOTT = ?
    	</query>
    	<query nome="W9APPA" tipo="select">
			select PROCEDURA_ACC,PREINFORMAZIONE, TERMINE_RIDOTTO, ID_MODO_INDIZIONE, W9LOTT.ID_MODO_GARA, NVL(NUM_IMPRESE_INVITATE,0), 
	    		NUM_IMPRESE_RICHIEDENTI, NVL(NUM_IMPRESE_OFFERENTI,0), NUM_OFFERTE_AMMESSE, DATA_VERB_AGGIUDICAZIONE, DATA_SCADENZA_RICHIESTA_INVITO, 
	    		DATA_SCADENZA_PRES_OFFERTA, IMPORTO_AGGIUDICAZIONE, W9LOTT.ID_SCELTA_CONTRAENTE, NVL(IMPORTO_LAVORI,0),
	    		NVL(IMPORTO_SERVIZI,0),NVL(IMPORTO_FORNITURE,0),NVL(W9APPA.IMPORTO_ATTUAZIONE_SICUREZZA,0),IMPORTO_DISPOSIZIONE,
				  NVL(IMPORTO_PROGETTAZIONE,0), case when W9APPA.REQUISITI_SETT_SPEC = 2 then '1' else '2' end,
    			case when W9APPA.REQUISITI_SETT_SPEC = 1 then '1' else '2' end, W9LOTT.ID_TIPO_PRESTAZIONE,
	    		W9LOTT.CUP, FLAG_ACCORDO_QUADRO, W9LOTT.LUOGO_ISTAT, W9LOTT.LUOGO_NUTS,NVL(ASTA_ELETTRONICA,'2'), ROUND(PERC_RIBASSO_AGG,5), ROUND(PERC_OFF_AUMENTO,5),
	    		DATA_INVITO, NVL(NUM_MANIF_INTERESSE,0), DATA_MANIF_INTERESSE, FLAG_RICH_SUBAPPALTO, NVL(NUM_OFFERTE_ESCLUSE,0), 
	    		OFFERTA_MASSIMO, OFFERTA_MINIMA, ROUND(VAL_SOGLIA_ANOMALIA,5), NVL(NUM_OFFERTE_FUORI_SOGLIA,0), NVL(NUM_IMP_ESCL_INSUF_GIUST,0),
	    		COD_STRUMENTO, IMPORTO_SUBTOTALE, IMPORTO_COMPL_APPALTO, IMPORTO_COMPL_INTERVENTO, IMP_NON_ASSOG,
	    		W9APPA.OPERE_URBANIZ_SCOMPUTO, W9APPA.MODALITA_RIAGGIUDICAZIONE, 
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else ''  end as ID_SCHEDA_SIMOG,
				W9LOTT.CIG_MASTER_ML, RELAZIONE_UNICA 
			from W9APPA, W9FASI, W9LOTT
            where W9APPA.CODGARA = ? AND W9APPA.CODLOTT = ? AND W9APPA.NUM_APPA = ? AND 
	            W9FASI.CODGARA = W9APPA.CODGARA AND 
	            W9FASI.CODLOTT = W9APPA.CODLOTT AND
	            W9FASI.FASE_ESECUZIONE = 1 AND
	            W9FASI.NUM = W9APPA.NUM_APPA AND
	            W9LOTT.CODGARA = W9APPA.CODGARA AND
	            W9LOTT.CODLOTT = W9APPA.CODLOTT
    	</query>
    	<query nome="W9APPALAV" tipo="select">
			select ID_APPALTO
			from W9APPALAV, W9FASI
            where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9FASI.NUM_APPA = ?
	            AND W9APPALAV.CODGARA = W9FASI.CODGARA
	            AND W9APPALAV.CODLOTT = W9FASI.CODLOTT
	            AND W9FASI.FASE_ESECUZIONE = 1
    	</query>
    	<query nome="W9APPAFORN" tipo="select">
			select ID_APPALTO
			from W9APPAFORN, W9FASI
            where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9FASI.NUM_APPA = ?
	            AND W9APPAFORN.CODGARA = W9FASI.CODGARA
	            AND W9APPAFORN.CODLOTT = W9FASI.CODLOTT
	            AND W9FASI.FASE_ESECUZIONE = 1
    	</query>
    	<query nome="W9COND" tipo="select">
			select ID_CONDIZIONE
			from W9COND, W9FASI
            where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9FASI.NUM_APPA = ? 
	            AND W9COND.CODGARA = W9FASI.CODGARA
	            AND W9COND.CODLOTT = W9FASI.CODLOTT
	            AND (W9FASI.FASE_ESECUZIONE = 1 OR W9FASI.FASE_ESECUZIONE = 987)
    	</query>
    	<query nome="W9FINA" tipo="select">
			select ID_FINANZIAMENTO,NVL(IMPORTO_FINANZIAMENTO,0)
			from W9FINA, W9FASI
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9FASI.NUM_APPA = ? 
	            AND W9FINA.CODGARA = W9FASI.CODGARA
	            AND W9FINA.CODLOTT = W9FASI.CODLOTT
	            AND W9FINA.NUM_APPA = W9FASI.NUM_APPA
	            AND (W9FASI.FASE_ESECUZIONE = 1 OR W9FASI.FASE_ESECUZIONE = 12) 
    	</query>
    	<query nome="W9REQU" tipo="select">
				select C1.CODAVCP as ID_CATEGORIA_PREVALENTE, C2.CODAVCP, '1', '2', '2'
				  from W9LOTT LEFT JOIN W9CODICI_AVCP C2 ON W9LOTT.CLASCAT = C2.CODSITAT, W9CODICI_AVCP C1
				 where W9LOTT.CODGARA = ? and W9LOTT.CODLOTT = ? and W9LOTT.ID_CATEGORIA_PREVALENTE IS NOT NULL
				   and W9LOTT.ID_CATEGORIA_PREVALENTE = C1.CODSITAT and C1.TABCOD = 'W3z03' and C2.TABCOD = 'W3z11' 
			  union
			 	select C1.CODAVCP as ID_CATEGORIA_PREVALENTE, C2.CODAVCP, '2', W9LOTTCATE.SCORPORABILE, W9LOTTCATE.SUBAPPALTABILE
				  from W9LOTTCATE LEFT JOIN W9CODICI_AVCP C2 ON W9LOTTCATE.CLASCAT = C2.CODSITAT, W9CODICI_AVCP C1
				 where W9LOTTCATE.CODGARA = ? and W9LOTTCATE.CODLOTT = ? 
				   and W9LOTTCATE.CATEGORIA = C1.CODSITAT and C1.TABCOD = 'W3z03' and C2.TABCOD = 'W3z11'
    	</query>
    	<query nome="W9AGGI" tipo="select">
			  select ID_TIPOAGG, RUOLO, FLAG_AVVALIMENTO,
	          (select IMPR.CFIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as CODICE_FISCALE_AGGIUDICATARIO,
	          (select IMPR.CFIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP_AUSILIARIA) as CF_AUSILIARIA,
	          (select IMPR.PIVIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as PIVIMP,
	          (select IMPR.PIVIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP_AUSILIARIA) as PIVIMP_AUSILIARIA,
	          (select IMPR.NAZIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as NAZIMP,
	          ID_GRUPPO, IMPORTO_AGGIUDICAZIONE, PERC_RIBASSO_AGG, PERC_OFF_AUMENTO
			    from W9AGGI, W9FASI
			   where W9AGGI.CODGARA = ? AND
				W9AGGI.CODLOTT = ? AND
				W9AGGI.NUM_APPA = ? AND
				W9AGGI.CODGARA = W9FASI.CODGARA AND
				W9AGGI.CODLOTT = W9FASI.CODLOTT AND
				(W9FASI.FASE_ESECUZIONE = 1 OR W9FASI.FASE_ESECUZIONE = 12 OR W9FASI.FASE_ESECUZIONE = 987) AND
				W9FASI.NUM_APPA = W9AGGI.NUM_APPA
    	</query>
    	<query nome="W9AGGI_AUSILIARIA" tipo="select">
			select FLAG_AVVALIMENTO,
				(select IMPR.CFIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as CODICE_FISCALE_AGGIUDICATARIO,
				(select IMPR.PIVIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as PIVIMP,
				(select IMPR.NAZIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as NAZIMP,
				(select IMPR.CFIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP_AUSILIARIA) as CODICE_FISCALE_AUSILIARIA,
				(select IMPR.PIVIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP_AUSILIARIA) as PIVIMP_AUSILIARIA,
				(select IMPR.NAZIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP_AUSILIARIA) as NAZIMP_AUSILIARIA
			from W9AGGI, W9FASI
			where W9AGGI.CODGARA = ? AND
				W9AGGI.CODLOTT = ? AND
				W9AGGI.NUM_APPA = ? AND
				W9AGGI.CODGARA = W9FASI.CODGARA AND
				W9AGGI.CODLOTT = W9FASI.CODLOTT AND
				(W9FASI.FASE_ESECUZIONE = 1 OR W9FASI.FASE_ESECUZIONE = 12) AND
				W9FASI.NUM_APPA = W9AGGI.NUM_APPA
    	</query>
    	<query nome="W9LOTT_CUP" tipo="select">
    		select CUP, CIG from W9LOTT where CODGARA=? AND CODLOTT=?
    	</query>
    	<query nome="W9AGGI_POSIZIONI" tipo="select">
			  select (select IMPR.CFIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as CODICE_FISCALE_AGGIUDICATARIO,
	           W9AGGI.CODICE_INPS, W9AGGI.CODICE_INAIL, W9AGGI.CODICE_CASSA,
	           (select IMPR.PIVIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as PIVIMP,
	           (select IMPR.NAZIMP from IMPR where IMPR.CODIMP = W9AGGI.CODIMP) as NAZIMP 
			    from W9AGGI, W9FASI
            where W9AGGI.CODGARA = ? AND
	            W9AGGI.CODLOTT = ? AND
				W9AGGI.NUM_APPA = ? AND
	            W9FASI.CODGARA = W9AGGI.CODGARA AND
	            W9FASI.CODLOTT = W9AGGI.CODLOTT AND
				W9FASI.NUM_APPA = W9AGGI.NUM_APPA AND
	            W9FASI.FASE_ESECUZIONE = 2
    	</query>
    	<query nome="W9APPA_SOTTOSOGLIA" tipo="select">
    		select W9LOTT.LUOGO_ISTAT, W9LOTT.LUOGO_NUTS, W9LOTT.CUP,
    			W9APPA.IMPORTO_COMPL_APPALTO, W9APPA.IMPORTO_DISPOSIZIONE,
    			W9LOTT.ID_SCELTA_CONTRAENTE, NVL(W9APPA.ASTA_ELETTRONICA,'2'), 
    			ROUND(W9APPA.PERC_RIBASSO_AGG,5), ROUND(W9APPA.PERC_OFF_AUMENTO,5),
    			W9APPA.IMPORTO_AGGIUDICAZIONE, W9APPA.DATA_VERB_AGGIUDICAZIONE,
    			W9APPA.DATA_STIPULA, W9APPA.DATA_TERMINE,W9APPA.DURATA_CON,
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG,
				W9LOTT.CIG
		   from W9APPA, W9FASI, W9LOTT, W9GARA
		  where W9APPA.CODGARA = ? AND W9APPA.CODLOTT = ? AND W9APPA.NUM_APPA = ? AND 
				W9FASI.CODGARA = W9APPA.CODGARA AND
				W9FASI.CODLOTT = W9APPA.CODLOTT AND
				W9LOTT.CODGARA = W9GARA.CODGARA AND
				W9FASI.NUM = W9APPA.NUM_APPA AND
				W9LOTT.CODGARA = W9APPA.CODGARA AND
				W9LOTT.CODLOTT = W9APPA.CODLOTT AND
				W9LOTT.ART_E1 = '2' AND
				W9FASI.FASE_ESECUZIONE = 987 AND
				<![CDATA[ W9GARA.TIPO_APP <> 11 ]]>
    	</query>
    	<query nome="W9APPA_ESCLUSO" tipo="select">
    		select W9LOTT.LUOGO_ISTAT, W9LOTT.LUOGO_NUTS, W9LOTT.CUP,
    			W9APPA.IMPORTO_COMPL_APPALTO, W9APPA.IMPORTO_DISPOSIZIONE,
    			W9LOTT.ID_SCELTA_CONTRAENTE, NVL(W9APPA.ASTA_ELETTRONICA,'2'), 
    			ROUND(W9APPA.PERC_RIBASSO_AGG,5), ROUND(W9APPA.PERC_OFF_AUMENTO,5),
    			W9APPA.IMPORTO_AGGIUDICAZIONE, W9APPA.DATA_VERB_AGGIUDICAZIONE,
    			W9APPA.DATA_STIPULA, W9APPA.DATA_TERMINE, W9APPA.DURATA_CON,
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else ''  end as ID_SCHEDA_SIMOG 
 			from W9APPA, W9FASI, W9LOTT
            where W9APPA.CODGARA = ? AND W9APPA.CODLOTT = ? AND W9APPA.NUM_APPA = ? AND 
	            W9FASI.CODGARA = W9APPA.CODGARA AND 
	            W9FASI.CODLOTT = W9APPA.CODLOTT AND
	            W9FASI.FASE_ESECUZIONE = 987 AND
	            W9LOTT.ART_E1 = '1' AND
	            W9FASI.NUM = W9APPA.NUM_APPA AND
	            W9LOTT.CODGARA = W9APPA.CODGARA AND
	            W9LOTT.CODLOTT = W9APPA.CODLOTT
    	</query>
    	<query nome="W9APPA_ADESIONE" tipo="select">
    		select W9LOTT.LUOGO_ISTAT, W9LOTT.LUOGO_NUTS, W9APPA.COD_STRUMENTO,
    			NVL(W9APPA.IMPORTO_LAVORI,0), NVL(W9APPA.IMPORTO_SERVIZI,0), NVL(W9APPA.IMPORTO_FORNITURE,0),
    			ROUND(W9APPA.PERC_RIBASSO_AGG,5), ROUND(W9APPA.PERC_OFF_AUMENTO,5),
    			W9APPA.IMPORTO_AGGIUDICAZIONE, W9APPA.DATA_VERB_AGGIUDICAZIONE,
    			W9APPA.FLAG_RICH_SUBAPPALTO, 
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG
			  from W9APPA, W9FASI, W9LOTT
             where W9APPA.CODGARA = ? AND W9APPA.CODLOTT = ? AND W9APPA.NUM_APPA = ? AND 
	            W9FASI.CODGARA = W9APPA.CODGARA AND 
	            W9FASI.CODLOTT = W9APPA.CODLOTT AND
	            W9FASI.FASE_ESECUZIONE = 12 AND
	            W9FASI.NUM = W9APPA.NUM_APPA AND
	            W9LOTT.CODGARA = W9APPA.CODGARA AND
	            W9LOTT.CODLOTT = W9APPA.CODLOTT
    	</query>
    	<query nome="W9INIZ_STIPULA" tipo="select">
    		select W9INIZ.DATA_STIPULA, W9INIZ.DATA_DECORRENZA, W9INIZ.DATA_SCADENZA,
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG
			  from W9LOTT join W9INIZ on W9LOTT.CODGARA = W9INIZ.CODGARA AND W9LOTT.CODLOTT=W9INIZ.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9INIZ.CODGARA AND W9FASI.CODLOTT = W9INIZ.CODLOTT AND W9FASI.NUM = W9INIZ.NUM_INIZ
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9INIZ.NUM_INIZ = ? AND
						W9FASI.FASE_ESECUZIONE = 11

    	</query>
    	<query nome="W9PUES_STIPULA" tipo="select">
    		select W9PUES.DATA_GUCE, W9PUES.DATA_GURI, NVL(W9PUES.QUOTIDIANI_NAZ,0), NVL(W9PUES.QUOTIDIANI_REG,0), 
	    		W9PUES.PROFILO_COMMITTENTE, NVL(W9PUES.SITO_MINISTERO_INF_TRASP,'2'), NVL(W9PUES.SITO_OSSERVATORIO_CP,'2'),
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else ''  end as ID_SCHEDA_SIMOG
			from W9LOTT join W9PUES on W9LOTT.CODGARA = W9PUES.CODGARA AND W9LOTT.CODLOTT=W9PUES.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9PUES.CODGARA AND W9FASI.CODLOTT = W9PUES.CODLOTT AND W9FASI.NUM = W9PUES.NUM_INIZ
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9PUES.NUM_INIZ = ? AND 
						W9FASI.FASE_ESECUZIONE = 11
    	</query>
    	<query nome="W9INCA_AGGIUDICAZIONE" tipo="select">
            select W9INCA.SEZIONE, W9INCA.ID_RUOLO, W9INCA.CIG_PROG_ESTERNA, W9INCA.DATA_AFF_PROG_ESTERNA, W9INCA.DATA_CONS_PROG_ESTERNA,
	            (select TECNI.CFTEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as CODICE_FISCALE_RESPONSABILE,
	            (select TECNI.PIVATEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as PIVATEC
           	from W9INCA, W9FASI
            where W9FASI.CODGARA = ? AND
	            W9FASI.CODLOTT = ? AND
				W9FASI.NUM_APPA = ? AND
	            W9FASI.CODGARA = W9INCA.CODGARA AND
	            W9FASI.CODLOTT = W9INCA.CODLOTT AND
	            W9FASI.NUM = W9INCA.NUM AND
	            (W9INCA.SEZIONE = 'PA' OR W9INCA.SEZIONE = 'RA') AND
	            W9FASI.FASE_ESECUZIONE = 1
    	</query>
    	<query nome="W9INCA_SOTTOSOGLIA" tipo="select">
            select W9INCA.SEZIONE, W9INCA.ID_RUOLO, W9INCA.CIG_PROG_ESTERNA, W9INCA.DATA_AFF_PROG_ESTERNA, W9INCA.DATA_CONS_PROG_ESTERNA,
	            (select TECNI.CFTEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as CODICE_FISCALE_RESPONSABILE,
	            (select TECNI.PIVATEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as PIVATEC
           	from W9INCA, W9FASI
            where W9FASI.CODGARA = ? AND
	            W9FASI.CODLOTT = ? AND
				W9FASI.NUM_APPA = ? AND
	            W9FASI.CODGARA = W9INCA.CODGARA AND
	            W9FASI.CODLOTT = W9INCA.CODLOTT AND
	            W9FASI.NUM = W9INCA.NUM AND
	            W9INCA.SEZIONE = 'RS' AND
	            W9FASI.FASE_ESECUZIONE = 987
    	</query>
    	<query nome="W9INCA_ESCLUSO" tipo="select">
            select W9INCA.SEZIONE, W9INCA.ID_RUOLO, W9INCA.CIG_PROG_ESTERNA, W9INCA.DATA_AFF_PROG_ESTERNA, W9INCA.DATA_CONS_PROG_ESTERNA,
	            (select TECNI.CFTEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as CODICE_FISCALE_RESPONSABILE,
	            (select TECNI.PIVATEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as PIVATEC
           	from W9INCA, W9FASI
            where W9FASI.CODGARA = ? AND
	            W9FASI.CODLOTT = ? AND
				W9FASI.NUM_APPA = ? AND
	            W9FASI.CODGARA = W9INCA.CODGARA AND
	            W9FASI.CODLOTT = W9INCA.CODLOTT AND
	            W9FASI.NUM = W9INCA.NUM AND
	            W9INCA.SEZIONE = 'RE' AND
	            W9FASI.FASE_ESECUZIONE = 987
    	</query>
    	<query nome="W9INCA_ADESIONE" tipo="select">
            select W9INCA.SEZIONE, W9INCA.ID_RUOLO, W9INCA.CIG_PROG_ESTERNA, W9INCA.DATA_AFF_PROG_ESTERNA, W9INCA.DATA_CONS_PROG_ESTERNA,
	            (select TECNI.CFTEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as CODICE_FISCALE_RESPONSABILE,
	            (select TECNI.PIVATEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as PIVATEC
           	from W9INCA, W9FASI
            where W9FASI.CODGARA = ? AND
	            W9FASI.CODLOTT = ? AND
				W9FASI.NUM_APPA = ? AND
	            W9FASI.CODGARA = W9INCA.CODGARA AND
	            W9FASI.CODLOTT = W9INCA.CODLOTT AND
	            W9FASI.NUM = W9INCA.NUM AND
	            W9INCA.SEZIONE = 'RQ' AND
	            W9FASI.FASE_ESECUZIONE = 12
    	</query>
    	<query nome="W9INCA_INIZIO" tipo="select">
            select W9INCA.SEZIONE, W9INCA.ID_RUOLO, W9INCA.CIG_PROG_ESTERNA, W9INCA.DATA_AFF_PROG_ESTERNA, W9INCA.DATA_CONS_PROG_ESTERNA,
	            (select TECNI.CFTEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as CODICE_FISCALE_RESPONSABILE,
	            (select TECNI.PIVATEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as PIVATEC
          	from W9INCA, W9FASI
            where W9FASI.CODGARA = ? AND
	            W9FASI.CODLOTT = ? AND
				W9INCA.NUM = ? AND
	            W9FASI.CODGARA = W9INCA.CODGARA AND
	            W9FASI.CODLOTT = W9INCA.CODLOTT AND
	            W9FASI.NUM = W9INCA.NUM AND
	            W9INCA.SEZIONE = 'IN' AND
	            W9INCA.ID_RUOLO NOT IN (98,99) AND
	            W9FASI.FASE_ESECUZIONE = 2
    	</query>
    	<query nome="W9INCA_COLLAUDO" tipo="select">
            select W9INCA.SEZIONE, W9INCA.ID_RUOLO, W9INCA.CIG_PROG_ESTERNA, W9INCA.DATA_AFF_PROG_ESTERNA, W9INCA.DATA_CONS_PROG_ESTERNA,
	            (select TECNI.CFTEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as CODICE_FISCALE_RESPONSABILE,
	            (select TECNI.PIVATEC from TECNI where TECNI.CODTEC = W9INCA.CODTEC) as PIVATEC
           	from W9INCA, W9FASI
            where W9FASI.CODGARA = ? AND
	            W9FASI.CODLOTT = ? AND
				W9FASI.NUM_APPA = ? AND
	            W9FASI.CODGARA = W9INCA.CODGARA AND
	            W9FASI.CODLOTT = W9INCA.CODLOTT AND
	            W9FASI.NUM = W9INCA.NUM AND
	            W9INCA.SEZIONE = 'CO' AND
	            W9FASI.FASE_ESECUZIONE = 5
    	</query>
    	<query nome="W9INIZ" tipo="select">
			select W9INIZ.DATA_STIPULA, W9INIZ.DATA_ESECUTIVITA, W9INIZ.IMPORTO_CAUZIONE, W9INIZ.DATA_INI_PROG_ESEC, W9INIZ.DATA_APP_PROG_ESEC,
				W9INIZ.FLAG_FRAZIONATA, W9INIZ.DATA_VERBALE_CONS, W9INIZ.DATA_VERBALE_DEF, W9INIZ.FLAG_RISERVA, W9INIZ.DATA_VERB_INIZIO, W9INIZ.DATA_TERMINE,
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG
			from W9LOTT join W9INIZ on W9LOTT.CODGARA = W9INIZ.CODGARA AND W9LOTT.CODLOTT=W9INIZ.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9INIZ.CODGARA AND W9FASI.CODLOTT = W9INIZ.CODLOTT AND W9FASI.NUM = W9INIZ.NUM_INIZ
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9INIZ.NUM_INIZ = ? AND
				W9FASI.FASE_ESECUZIONE = 2
    	</query>
    	<query nome="W9PUES" tipo="select">
    		select W9PUES.DATA_GUCE, W9PUES.DATA_GURI, W9PUES.DATA_ALBO, NVL(W9PUES.QUOTIDIANI_NAZ,0), NVL(W9PUES.QUOTIDIANI_REG,0), 
	    		W9PUES.PROFILO_COMMITTENTE, NVL(W9PUES.SITO_MINISTERO_INF_TRASP,'2'), NVL(W9PUES.SITO_OSSERVATORIO_CP,'2'),
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG
			from W9LOTT join W9PUES on W9LOTT.CODGARA = W9PUES.CODGARA AND W9LOTT.CODLOTT=W9PUES.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9PUES.CODGARA AND W9FASI.CODLOTT = W9PUES.CODLOTT AND W9FASI.NUM = W9PUES.NUM_INIZ
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9PUES.NUM_INIZ = ? AND
	      		W9FASI.FASE_ESECUZIONE = 2 
    	</query>
    	<query nome="W9AVAN" tipo="select">
    		select W9AVAN.FLAG_PAGAMENTO, case when W9AVAN.NUM_AVAN=1 then W9AVAN.DATA_ANTICIPAZIONE else null end as DATA_ANTICIPAZIONE,
    				case when W9AVAN.NUM_AVAN=1 then W9AVAN.IMPORTO_ANTICIPAZIONE else null end as IMPORTO_ANTICIPAZIONE, W9AVAN.DATA_RAGGIUNGIMENTO,
    				W9AVAN.IMPORTO_SAL,W9AVAN.DATA_CERTIFICATO, W9AVAN.IMPORTO_CERTIFICATO, W9AVAN.FLAG_RITARDO,
    				W9AVAN.NUM_GIORNI_SCOST, W9AVAN.NUM_GIORNI_PROROGA, W9AVAN.DENOM_AVANZAMENTO,
	    			case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE,
						case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG, W9AVAN.NUM_AVAN
					from W9LOTT join W9AVAN on W9LOTT.CODGARA = W9AVAN.CODGARA AND W9LOTT.CODLOTT=W9AVAN.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9AVAN.CODGARA AND W9FASI.CODLOTT = W9AVAN.CODLOTT AND W9FASI.NUM = W9AVAN.NUM_AVAN
				 where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9FASI.NUM_APPA = ? AND 
	      		W9FASI.FASE_ESECUZIONE = 3
    	</query>
	   	<query nome="W9CONC" tipo="select">
    		select W9CONC.ID_MOTIVO_INTERR, W9CONC.ID_MOTIVO_RISOL, W9CONC.DATA_RISOLUZIONE, W9CONC.FLAG_ONERI, 
	    		W9CONC.ONERI_RISOLUZIONE, NVL(W9CONC.FLAG_POLIZZA,'2'), W9CONC.DATA_ULTIMAZIONE, NVL(W9CONC.NUM_INFORTUNI,0), NVL(W9CONC.NUM_INF_PERM,0), NVL(W9CONC.NUM_INF_MORT,0),
	    		W9CONC.DATA_VERBALE_CONSEGNA, W9CONC.TERMINE_CONTRATTO_ULT,
	    		W9CONC.NUM_GIORNI_PROROGA,
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG
			from W9LOTT join W9CONC on W9LOTT.CODGARA = W9CONC.CODGARA AND W9LOTT.CODLOTT=W9CONC.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9CONC.CODGARA AND W9FASI.CODLOTT = W9CONC.CODLOTT AND W9FASI.NUM = W9CONC.NUM_CONC
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9CONC.NUM_CONC = ? AND
	      		W9FASI.FASE_ESECUZIONE = 4 
    	</query>
    	<query nome="W9COLL" tipo="select">
    		select W9COLL.DATA_REGOLARE_ESEC, W9COLL.DATA_COLLAUDO_STAT, W9COLL.MODO_COLLAUDO, W9COLL.DATA_NOMINA_COLL, 
    			W9COLL.DATA_INIZIO_OPER, W9COLL.DATA_CERT_COLLAUDO, W9COLL.DATA_DELIBERA, W9COLL.ESITO_COLLAUDO, 
	    		W9COLL.IMP_FINALE_LAVORI, W9COLL.IMP_FINALE_SERVIZI, W9COLL.IMP_FINALE_FORNIT, W9COLL.IMP_FINALE_SECUR, W9COLL.IMP_PROGETTAZIONE, W9COLL.IMP_DISPOSIZIONE, 
	    		W9COLL.AMM_NUM_DEFINITE, W9COLL.AMM_NUM_DADEF, W9COLL.AMM_IMPORTO_RICH, W9COLL.AMM_IMPORTO_DEF, 
	    		W9COLL.ARB_NUM_DEFINITE, W9COLL.ARB_NUM_DADEF, W9COLL.ARB_IMPORTO_RICH, W9COLL.ARB_IMPORTO_DEF, 
	    		W9COLL.GIU_NUM_DEFINITE, W9COLL.GIU_NUM_DADEF, W9COLL.GIU_IMPORTO_RICH, W9COLL.GIU_IMPORTO_DEF, 
	    		W9COLL.TRA_NUM_DEFINITE, W9COLL.TRA_NUM_DADEF, W9COLL.TRA_IMPORTO_RICH, W9COLL.TRA_IMPORTO_DEF, 
	    		W9COLL.LAVORI_ESTESI, W9COLL.TIPO_COLLAUDO,
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG
			from W9LOTT join W9COLL on W9LOTT.CODGARA = W9COLL.CODGARA AND W9LOTT.CODLOTT=W9COLL.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9COLL.CODGARA AND W9FASI.CODLOTT = W9COLL.CODLOTT AND W9FASI.NUM = W9COLL.NUM_COLL
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9COLL.NUM_COLL = ? AND 
	      		W9FASI.FASE_ESECUZIONE = 5 
    	</query>
    	<query nome="W9RITA" tipo="select">
    		select W9RITA.DATA_TERMINE, W9RITA.DATA_CONSEGNA, W9RITA.TIPO_COMUN, W9RITA.DURATA_SOSP, W9RITA.MOTIVO_SOSP, W9RITA.DATA_IST_RECESSO,
   			   W9RITA.FLAG_ACCOLTA, W9RITA.FLAG_TARDIVA, W9RITA.FLAG_RIPRESA, W9RITA.FLAG_RISERVA, W9RITA.IMPORTO_SPESE, W9RITA.IMPORTO_ONERI,
		    	case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG 
			from W9LOTT join W9RITA on W9LOTT.CODGARA = W9RITA.CODGARA AND W9LOTT.CODLOTT=W9RITA.CODLOTT
					join W9FASI on  W9FASI.CODGARA = W9RITA.CODGARA AND W9FASI.CODLOTT = W9RITA.CODLOTT AND W9FASI.NUM = W9RITA.NUM_RITA
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9RITA.NUM_RITA = ? AND
	      		W9FASI.FASE_ESECUZIONE = 10 
    	</query>
    	<query nome="W9ACCO" tipo="select">
    		select W9ACCO.DATA_ACCORDO, W9ACCO.ONERI_DERIVANTI, NVL(W9ACCO.NUM_RISERVE,0),
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE,
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG,
				W9ACCO.NUM_ACCO
			from W9LOTT join W9ACCO on W9LOTT.CODGARA = W9ACCO.CODGARA AND W9LOTT.CODLOTT=W9ACCO.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9ACCO.CODGARA AND W9FASI.CODLOTT = W9ACCO.CODLOTT AND W9FASI.NUM = W9ACCO.NUM_ACCO
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9ACCO.NUM_APPA = ? AND
	      		W9FASI.FASE_ESECUZIONE = 8 
    	</query>
    	   	<query nome="W9SOSP" tipo="select">
    		select W9SOSP.DATA_VERB_SOSP, W9SOSP.DATA_VERB_RIPR,  W9SOSP.ID_MOTIVO_SOSP,
                W9SOSP.FLAG_SUPERO_TEMPO, W9SOSP.FLAG_RISERVE, W9SOSP.FLAG_VERBALE,
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG,
	    		W9SOSP.NUM_SOSP
			from W9LOTT join W9SOSP on W9LOTT.CODGARA = W9SOSP.CODGARA AND W9LOTT.CODLOTT=W9SOSP.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9SOSP.CODGARA AND W9FASI.CODLOTT = W9SOSP.CODLOTT AND W9FASI.NUM = W9SOSP.NUM_SOSP
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9SOSP.NUM_APPA = ? AND
	    		W9FASI.FASE_ESECUZIONE = 6
    	</query>
    	<query nome="W9VARI" tipo="select">
    		select W9VARI.DATA_VERB_APPR, W9VARI.ALTRE_MOTIVAZIONI,  
	   			W9VARI.IMP_RIDET_LAVORI, W9VARI.IMP_RIDET_SERVIZI, W9VARI.IMP_RIDET_FORNIT,
	   			W9VARI.IMP_SICUREZZA, W9VARI.IMP_PROGETTAZIONE, W9VARI.IMP_DISPOSIZIONE,
	        W9VARI.DATA_ATTO_AGGIUNTIVO, W9VARI.NUM_GIORNI_PROROGA,W9VARI.NUM_VARI,
	    		case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE,
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG,
	    		IMP_NON_ASSOG 
			from W9LOTT join W9VARI on W9LOTT.CODGARA = W9VARI.CODGARA AND W9LOTT.CODLOTT=W9VARI.CODLOTT
						join W9FASI on  W9FASI.CODGARA = W9VARI.CODGARA AND W9FASI.CODLOTT = W9VARI.CODLOTT AND W9FASI.NUM = W9VARI.NUM_VARI
			where W9FASI.CODGARA = ? AND W9FASI.CODLOTT = ? AND W9VARI.NUM_VARI = ? AND
	      		W9FASI.FASE_ESECUZIONE = 7 
    	</query>
    	<query nome="W9MOTI" tipo="select">
    		select W9MOTI.ID_MOTIVO_VAR
    		from W9MOTI
    		where W9MOTI.CODGARA = ? AND
	    		W9MOTI.CODLOTT = ? AND
	    		W9MOTI.NUM_VARI = ?  AND W9MOTI.ID_MOTIVO_VAR IS NOT NULL
    	</query>
    	<query nome="W9SUBA" tipo="select">
			select (select IMPR.CFIMP from IMPR where IMPR.CODIMP = W9SUBA.CODIMP) as CF_DITTA,
				W9SUBA.DATA_AUTORIZZAZIONE, W9SUBA.OGGETTO_SUBAPPALTO,
				W9SUBA.IMPORTO_PRESUNTO,W9SUBA.IMPORTO_EFFETTIVO,
				C.CODAVCP as ID_CATEGORIA, W9SUBA.ID_CPV,
				(select IMPR.PIVIMP from IMPR where IMPR.CODIMP = W9SUBA.CODIMP) as PIVIMP,
				(select IMPR.CFIMP from IMPR where IMPR.CODIMP = W9SUBA.CODIMP_AGGIUDICATRICE) as CF_DITTA_2,
				(select IMPR.PIVIMP from IMPR where IMPR.CODIMP = W9SUBA.CODIMP_AGGIUDICATRICE) as PIVIMP_2,
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then '' else W9FASI.ID_SCHEDA_LOCALE end as ID_SCHEDA_LOCALE, 
				case when W9LOTT.ID_SCHEDA_SIMOG is not null then W9FASI.ID_SCHEDA_SIMOG else '' end as ID_SCHEDA_SIMOG,
				W9SUBA.NUM_SUBA
			from W9SUBA, W9FASI, W9LOTT, W9CODICI_AVCP C
			where W9FASI.CODGARA = ? AND
				W9FASI.CODLOTT = ? AND
				W9SUBA.NUM_APPA = ? AND
				W9FASI.CODGARA = W9LOTT.CODGARA AND
				W9FASI.CODLOTT = W9LOTT.CODLOTT AND
				W9FASI.CODGARA = W9SUBA.CODGARA AND
				W9FASI.CODLOTT = W9SUBA.CODLOTT AND
				W9FASI.NUM = W9SUBA.NUM_SUBA AND
				W9FASI.FASE_ESECUZIONE = 9 AND
				W9LOTT.IMPORTO_TOT > 40000 AND
				ART_E1='2' AND
				W9SUBA.ID_CATEGORIA = C.CODSITAT and C.TABCOD = 'W3z03'
    	</query>
    	<query nome="TECNI" tipo="select">
			select distinct CFTEC, NVL(COGTEI,NOMTEC), NVL(NOMETEI,' '),
				NVL(TELTEC,' '), NVL(EMATEC,' '), NVL(FAXTEC,' '),
				LOCTEC,	NVL(INDTEC,' '), NVL(NCITEC,' '),
				NVL(CAPTEC,' '), NVL(CITTEC,' ')
			from 
			(select i.CODGARA as CODGARA,i.CODLOTT as CODLOTT,i.CODTEC as CODTEC from W9INCA i join W9FASI f on i.CODGARA = f.CODGARA AND i.CODLOTT = f.CODLOTT
			Where i.ID_RUOLO NOT IN (98,99)
			UNION
			SELECT W9LOTT.CODGARA as CODGARA, W9LOTT.CODLOTT as CODLOTT,W9LOTT.RUP as CODTEC FROM W9LOTT) u 
			join TECNI t on t.codtec=u.codtec
			where CODGARA = ? AND CODLOTT = ?
    	</query>
    	<query nome="IMPR" tipo="select">
			SELECT 	IMP.CFIMP, IMP.NOMEST, COALESCE(IMP.NCCIAA,' '), COALESCE(IMP.PIVIMP,' '), COALESCE(IMP.INDIMP,' '), COALESCE(IMP.NCIIMP,' '),
					COALESCE(IMP.CAPIMP,' '),COALESCE(IMP.LOCIMP,' '),COALESCE(IMP.PROIMP,' '), IMP.NAZIMP, IMP.CODIMP
			  FROM IMPR IMP, W9AGGI ag 
			 WHERE IMP.CODIMP = ag.CODIMP AND ag.CODGARA = ? AND ag.CODLOTT = ? 
			union
			SELECT 	IMP.CFIMP, IMP.NOMEST, COALESCE(IMP.NCCIAA,' '), COALESCE(IMP.PIVIMP,' '), COALESCE(IMP.INDIMP,' '), COALESCE(IMP.NCIIMP,' '),
					COALESCE(IMP.CAPIMP,' '),COALESCE(IMP.LOCIMP,' '),COALESCE(IMP.PROIMP,' '), IMP.NAZIMP, IMP.CODIMP
			  FROM IMPR IMP, W9AGGI ag 
			 WHERE IMP.CODIMP = ag.CODIMP_AUSILIARIA AND ag.CODGARA = ? AND ag.CODLOTT = ? and ag.CODIMP_AUSILIARIA is not null
	    </query>
	    <query nome="IMPR_LEGALIRAPPRESENTANTI" tipo="select">
			SELECT 	COALESCE(TEIM.COGTIM, ' '), COALESCE(TEIM.NOMETIM, ' '), COALESCE(TEIM.CFTIM,' ') AS CF_RAPPRESENTANTE
	  		  FROM IMPR, TEIM, IMPLEG
	 		 WHERE IMPR.CODIMP = IMPLEG.CODIMP2 AND IMPLEG.CODLEG = TEIM.CODTIM AND IMPR.CODIMP = ? AND IMPLEG.LEGFIN IS NULL 
	    </query>
	    <query nome="IMPR_LEGALIRAPPRESENTANTI_DISPONIBILI" tipo="select">
			SELECT 	COALESCE(TEIM.COGTIM, ' '), COALESCE(TEIM.NOMETIM, ' '), COALESCE(TEIM.CFTIM,' ') AS CF_RAPPRESENTANTE, I.LEGFIN
	  		  FROM IMPR, TEIM, IMPLEG
	 		 WHERE IMPR.CODIMP = IMPLEG.CODIMP2 AND IMPLEG.CODLEG = TEIM.CODTIM AND IMPR.CODIMP = ? AND IMPLEG.LEGFIN IS NOT NULL			
			ORDER BY IMPLEG.LEGFIN DESC
	    </query>
    	<query nome="W9CUI" tipo="select">
    		select CODCUI from W9LOTT where CODGARA = ? AND CODLOTT = ?
    	</query>
    	<query nome="W9LOTT_AGGIORNACODCUI" tipo="select">
    		update W9LOTT set CODCUI = (SELECT CIG FROM W9LOTT where CODGARA = ? AND CODLOTT = ?) + '-1' where CODGARA = ? AND CODLOTT = ?
    	</query>
	</metodo>
</Classe>
